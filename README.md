- テストケースは、どのような条件でどのような操作をしたらどのような結果が期待値がされるかを記述したもの

- テストケースをまとめたものをテストスイートと呼ぶ

- ソフトウェアテストは品質保証になるだけでなく、設計そのものが妥当であるかを検証する目的として完成度を図る役割も持つ

- テスト技法はホワイトボックステストとブラックボックステストに分類できる
  - ホワイトボックステストは内部ロジックや内部仕様について考慮してテストケースを設計する
  - ブラックボックステストは内部仕様は考慮せず、外部仕様のみからテストケースを設計する(業務知識が重要)

- 同値クラスに対するテストは、ソフトウェアが同様の結果をもたらす値を「同値クラス」としてグループ化しテストデータを選択する

- 境界値に対するテストは、ソフトウェアが異なる結果をもたらす値を「境界値」として境界値の近辺からテストデータを選択する
  - 経験的にプログラムは仕様上の境界値付近で不具合を生み出しやすいという性質を利用

- ユニットテストはプログラムとして実行できる仕様書となる
  - 対象のクラスやメソッドの仕様を動くプログラムとして記述することにより、仕様を明確にし保証する

- ユニットテストは繰り返し実行できるため、リグレッション(修正と無関係の箇所が壊れること=デグレーション)の恐れを最小限にして新しい機能追加や改修を行える
  - 変更に強くなり品質の高いソフトウェアを作ることができる

- テスト失敗時に影響範囲と条件が絞り込みやすくなるため、テストケースは可能な限り小さな単位で多く作るべき(問題の局所化)

- 可読性の低い、前提条件、実行、検証が複雑に入り組んでいるテストコードはメンテナンス性が悪く、テストの質にも影響する

- 実行順序に依存しない独立したテストを作る
  - シングルトンのリソースやデータベースにアクセスするテストは気をつける
  - テストの終了処理でデータやリソースを前の状態に戻す

- テストケースにおける重要なポイント
  - テストを行う前提条件
  - テストに用いる入力値や操作
  - テストを行ったときに期待する値や動作

- テスト対象となるクラスやオブジェクトは SUT(System Under Test)と呼ばれる
  - 1つのテストケースでは1つのSUTを対象にする
  - テストコードではテスト対象クラスのインスタンスを sut という変数で扱うことで理解しやすくなる

- テストコードに含まれる変数名は実測値に actual を、期待値に expected を使用する

- ユニットテストのフェーズ
  - setup
    - SUTの初期化、必要な入力値、期待される結果を準備
  - exercise
    - 1度だけSUTに対してテストする操作を実行
  - verify
    - 実測値が期待値と等価であるかを比較検証(assertion = 表明)
  - tear down
    - 次のテストに影響がないように後始末
    
- テストフィクスチャ(text fixtures)はテスト実行時に必要とされるすべてのデータや状態のこと
  - テストを行うための入力値とテストの期待値で構成される
  - 生成が容易でないオブジェクトの場合、テストコードの見通しを良くするために、テストフィクスチャや外部定義ファイルに記述する
  - テストケースごとに独立し、テストの実行ごとに初期化され終了時に開放する戦略は、フィレッシュフィクスチャと呼ばれる

- 初期状態として妥当な値が設定されているかコンストラクタを検証するテストではインスタンスの生成が実行フェーズに相当

- パラメータ化テスト(parameterized test)で記述することで、入力値と期待値をテストケースとして独立して定義できる(=テストケースとテストデータの分離)

- カテゴリ化テスト(categorized test)で実行対象を絞り込むことでスローテスト問題に対応できる
  - カテゴリを特定するマーカーインターフェースを付与する

- テストしやすさをテスタビリティ(testability)と呼ぶ

- リファクタリングはプログラムの外部的な振る舞いを変えずに、内部構造を変更しソースコードを整理するテクニック
  - 本来はリファクタリングを行う前にユニットテストを作成することで外部的な振る舞いが変わらない保証を先に作る

- ユニットテストの独立性を高めたい場合は依存するオブジェクトをテストダブル(test double)に置き換える方法が有効
  - double は代役や影武者の意味
  - モックやスタブを使う

- スタブは依存するクラスやモジュールの代用として使用する仮のクラスやモジュール
  - **スタブは仮の実装で予測可能な値を返すことで、予測が難しいテストケースを検証可能なテストケースにするのが目的**

- モックは依存クラスやモジュールが正しく利用されているかを検証する目的で使われる
  - **目的のメソッドがテストの実行中に呼び出されたかを検証するのが目的**
  - 呼び出し回数の検証などを独自実装するのは複雑なのでライブラリ(Mockito など)を使うのが一般的

- モック、スタブは両方の目的で使用されることがあるため、曖昧にどちらも指す場合がある
  - スタブはテストコード以外でも仮実装として利用されることがある
  - ライブラリはモック機能がスタブ機能の上位互換となるため、モック用ライブラリとして公開されている
